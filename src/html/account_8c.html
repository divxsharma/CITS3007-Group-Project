<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: account.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">account.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implements account-related functionality including creation, validation, and secure password handling using libsodium.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;account.h&quot;</code><br />
<code>#include &quot;<a class="el" href="logging_8h_source.html">logging.h</a>&quot;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;sodium.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &quot;banned.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for account.c:</div>
<div class="dyncontent">
<div class="center"><img src="account_8c__incl.png" border="0" usemap="#aaccount_8c" alt=""/></div>
<map name="aaccount_8c" id="aaccount_8c">
<area shape="rect" title="Implements account&#45;related functionality including creation, validation, and secure password handling..." alt="" coords="487,5,571,32"/>
<area shape="rect" href="account_8h_source.html" title=" " alt="" coords="108,80,193,107"/>
<area shape="rect" title=" " alt="" coords="5,155,88,181"/>
<area shape="rect" title=" " alt="" coords="208,155,272,181"/>
<area shape="rect" href="logging_8h.html" title="API for the logging system." alt="" coords="324,80,407,107"/>
<area shape="rect" title=" " alt="" coords="296,155,363,181"/>
<area shape="rect" title=" " alt="" coords="431,80,523,107"/>
<area shape="rect" title=" " alt="" coords="547,80,618,107"/>
<area shape="rect" title=" " alt="" coords="643,80,725,107"/>
<area shape="rect" title=" " alt="" coords="750,80,821,107"/>
<area shape="rect" title=" " alt="" coords="845,80,915,107"/>
<area shape="rect" title=" " alt="" coords="940,80,1015,107"/>
<area shape="rect" href="banned_8h_source.html" title=" " alt="" coords="1039,80,1121,107"/>
<area shape="rect" title=" " alt="" coords="113,155,183,181"/>
<area shape="rect" title=" " alt="" coords="387,155,461,181"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3024ccd4a9af5109d24e6c57565d74a1"><td class="memItemLeft" align="right" valign="top"><a id="a3024ccd4a9af5109d24e6c57565d74a1" name="a3024ccd4a9af5109d24e6c57565d74a1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>_POSIX_C_SOURCE</b>&#160;&#160;&#160;200809L</td></tr>
<tr class="separator:a3024ccd4a9af5109d24e6c57565d74a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad02d3e46290c33fe9d1b83dd56a36103"><td class="memItemLeft" align="right" valign="top"><a id="ad02d3e46290c33fe9d1b83dd56a36103" name="ad02d3e46290c33fe9d1b83dd56a36103"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_PW_LEN</b>&#160;&#160;&#160;128</td></tr>
<tr class="separator:ad02d3e46290c33fe9d1b83dd56a36103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a129a08f77b4b62d2e98a45bb0e0c757e"><td class="memItemLeft" align="right" valign="top"><a id="a129a08f77b4b62d2e98a45bb0e0c757e" name="a129a08f77b4b62d2e98a45bb0e0c757e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIN_PW_LEN</b>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a129a08f77b4b62d2e98a45bb0e0c757e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a429b8d0285e7ff4197c2170a1ee06b59"><td class="memItemLeft" align="right" valign="top"><a id="a429b8d0285e7ff4197c2170a1ee06b59" name="a429b8d0285e7ff4197c2170a1ee06b59"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_TIME_STR_LEN</b>&#160;&#160;&#160;64</td></tr>
<tr class="separator:a429b8d0285e7ff4197c2170a1ee06b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fe20280969d53d30eaefea36dfa9c19"><td class="memItemLeft" align="right" valign="top"><a id="a6fe20280969d53d30eaefea36dfa9c19" name="a6fe20280969d53d30eaefea36dfa9c19"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_DURATION</b>&#160;&#160;&#160;31536000</td></tr>
<tr class="separator:a6fe20280969d53d30eaefea36dfa9c19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09a3b394b8602092d58347b791158062"><td class="memItemLeft" align="right" valign="top"><a id="a09a3b394b8602092d58347b791158062" name="a09a3b394b8602092d58347b791158062"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_LINE_LEN</b>&#160;&#160;&#160;256</td></tr>
<tr class="separator:a09a3b394b8602092d58347b791158062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e6e3d60aed97cb34d19b00f87318e6c"><td class="memItemLeft" align="right" valign="top"><a id="a9e6e3d60aed97cb34d19b00f87318e6c" name="a9e6e3d60aed97cb34d19b00f87318e6c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>OPSLIMIT</b>&#160;&#160;&#160;crypto_pwhash_OPSLIMIT_INTERACTIVE</td></tr>
<tr class="separator:a9e6e3d60aed97cb34d19b00f87318e6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fa9c4326e38093bf1e23e0724bb12bd"><td class="memItemLeft" align="right" valign="top"><a id="a6fa9c4326e38093bf1e23e0724bb12bd" name="a6fa9c4326e38093bf1e23e0724bb12bd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MEMLIMIT</b>&#160;&#160;&#160;crypto_pwhash_MEMLIMIT_INTERACTIVE</td></tr>
<tr class="separator:a6fa9c4326e38093bf1e23e0724bb12bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab4b3c46b66720750719df193c4201b15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structaccount__t.html">account_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#ab4b3c46b66720750719df193c4201b15">account_create</a> (const char *userid, const char *plaintext_password, const char *email, const char *birthdate)</td></tr>
<tr class="memdesc:ab4b3c46b66720750719df193c4201b15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and initializes a new user account with validated and securely stored data.  <a href="account_8c.html#ab4b3c46b66720750719df193c4201b15">More...</a><br /></td></tr>
<tr class="separator:ab4b3c46b66720750719df193c4201b15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af686b29dd44e962dd68627d051e96a65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#af686b29dd44e962dd68627d051e96a65">account_free</a> (<a class="el" href="structaccount__t.html">account_t</a> *acc)</td></tr>
<tr class="memdesc:af686b29dd44e962dd68627d051e96a65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Securely deallocates and wipes an <code><a class="el" href="structaccount__t.html">account_t</a></code> structure from memory.  <a href="account_8c.html#af686b29dd44e962dd68627d051e96a65">More...</a><br /></td></tr>
<tr class="separator:af686b29dd44e962dd68627d051e96a65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5da35963ec07426278f66f9d37db58cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#a5da35963ec07426278f66f9d37db58cb">account_set_email</a> (<a class="el" href="structaccount__t.html">account_t</a> *acc, const char *new_email)</td></tr>
<tr class="memdesc:a5da35963ec07426278f66f9d37db58cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide user function to updates the email field of an existing <code><a class="el" href="structaccount__t.html">account_t</a></code> structure.  <a href="account_8c.html#a5da35963ec07426278f66f9d37db58cb">More...</a><br /></td></tr>
<tr class="separator:a5da35963ec07426278f66f9d37db58cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0051b990f5e6a9e4800ed05a7c72fb4d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#a0051b990f5e6a9e4800ed05a7c72fb4d">account_validate_password</a> (const <a class="el" href="structaccount__t.html">account_t</a> *acc, const char *plaintext_password)</td></tr>
<tr class="memdesc:a0051b990f5e6a9e4800ed05a7c72fb4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates a user's plaintext password against the stored password hash.  <a href="account_8c.html#a0051b990f5e6a9e4800ed05a7c72fb4d">More...</a><br /></td></tr>
<tr class="separator:a0051b990f5e6a9e4800ed05a7c72fb4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4ca3ecc137d919f74b096b4c9c69e06"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#aa4ca3ecc137d919f74b096b4c9c69e06">account_update_password</a> (<a class="el" href="structaccount__t.html">account_t</a> *acc, const char *new_plaintext_password)</td></tr>
<tr class="memdesc:aa4ca3ecc137d919f74b096b4c9c69e06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the stored password hash in an <code><a class="el" href="structaccount__t.html">account_t</a></code> structure with a new plaintext password provided from user.  <a href="account_8c.html#aa4ca3ecc137d919f74b096b4c9c69e06">More...</a><br /></td></tr>
<tr class="separator:aa4ca3ecc137d919f74b096b4c9c69e06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c3dd2f57c748c5d4502017deedcd1db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#a2c3dd2f57c748c5d4502017deedcd1db">account_record_login_success</a> (<a class="el" href="structaccount__t.html">account_t</a> *acc, ip4_addr_t ip)</td></tr>
<tr class="memdesc:a2c3dd2f57c748c5d4502017deedcd1db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Records a successful login for a user account, updating metadata and logging the event.  <a href="account_8c.html#a2c3dd2f57c748c5d4502017deedcd1db">More...</a><br /></td></tr>
<tr class="separator:a2c3dd2f57c748c5d4502017deedcd1db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa08ce919568178b2a576aa6cf4c26930"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#aa08ce919568178b2a576aa6cf4c26930">account_record_login_failure</a> (<a class="el" href="structaccount__t.html">account_t</a> *acc)</td></tr>
<tr class="memdesc:aa08ce919568178b2a576aa6cf4c26930"><td class="mdescLeft">&#160;</td><td class="mdescRight">Records a failed login attempt for the specified user account.  <a href="account_8c.html#aa08ce919568178b2a576aa6cf4c26930">More...</a><br /></td></tr>
<tr class="separator:aa08ce919568178b2a576aa6cf4c26930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9c70fb0d71e6d3a8281fe6d456c0bf0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#af9c70fb0d71e6d3a8281fe6d456c0bf0">account_is_banned</a> (const <a class="el" href="structaccount__t.html">account_t</a> *acc)</td></tr>
<tr class="memdesc:af9c70fb0d71e6d3a8281fe6d456c0bf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether a user account is currently banned based on the unban timestamp.  <a href="account_8c.html#af9c70fb0d71e6d3a8281fe6d456c0bf0">More...</a><br /></td></tr>
<tr class="separator:af9c70fb0d71e6d3a8281fe6d456c0bf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34a441e59238b76a8cd7f36c94a1ae1b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#a34a441e59238b76a8cd7f36c94a1ae1b">account_is_expired</a> (const <a class="el" href="structaccount__t.html">account_t</a> *acc)</td></tr>
<tr class="memdesc:a34a441e59238b76a8cd7f36c94a1ae1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines whether a user account has expired based on the expiration timestamp.  <a href="account_8c.html#a34a441e59238b76a8cd7f36c94a1ae1b">More...</a><br /></td></tr>
<tr class="separator:a34a441e59238b76a8cd7f36c94a1ae1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aada84f2a8333027836a619f14c554ba2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#aada84f2a8333027836a619f14c554ba2">account_set_unban_time</a> (<a class="el" href="structaccount__t.html">account_t</a> *acc, time_t t)</td></tr>
<tr class="memdesc:aada84f2a8333027836a619f14c554ba2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the unban time for a user account based on a duration from the current time.  <a href="account_8c.html#aada84f2a8333027836a619f14c554ba2">More...</a><br /></td></tr>
<tr class="separator:aada84f2a8333027836a619f14c554ba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10db748111392ca7df1d47f35a5e8b21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#a10db748111392ca7df1d47f35a5e8b21">account_set_expiration_time</a> (<a class="el" href="structaccount__t.html">account_t</a> *acc, time_t t)</td></tr>
<tr class="memdesc:a10db748111392ca7df1d47f35a5e8b21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the expiration time for a user account based on a duration from the current time.  <a href="account_8c.html#a10db748111392ca7df1d47f35a5e8b21">More...</a><br /></td></tr>
<tr class="separator:a10db748111392ca7df1d47f35a5e8b21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d1dafdb93c9614ad833f3f940263d28"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="account_8c.html#a0d1dafdb93c9614ad833f3f940263d28">account_print_summary</a> (const <a class="el" href="structaccount__t.html">account_t</a> *acct, int fd)</td></tr>
<tr class="memdesc:a0d1dafdb93c9614ad833f3f940263d28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints a summary of the given account to the specified file descriptor.  <a href="account_8c.html#a0d1dafdb93c9614ad833f3f940263d28">More...</a><br /></td></tr>
<tr class="separator:a0d1dafdb93c9614ad833f3f940263d28"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Implements account-related functionality including creation, validation, and secure password handling using libsodium. </p>
<p >This file contains functions for managing user accounts, including validating email and birthdate formats, enforcing strong password rules, and securely hashing and verifying passwords. It relies on the libsodium library for cryptographic operations and includes logging for error diagnosis.</p>
<dl class="section author"><dt>Author</dt><dd>Div Sharma [23810783] </dd>
<dd>
Pranav Rajput [23736075] </dd>
<dd>
William Lo [23722943] </dd>
<dd>
Zachary Wang [24648002] </dd>
<dd>
Jun Hao Dennis Lou [23067779]</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>No known bugs. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab4b3c46b66720750719df193c4201b15" name="ab4b3c46b66720750719df193c4201b15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4b3c46b66720750719df193c4201b15">&#9670;&nbsp;</a></span>account_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structaccount__t.html">account_t</a> * account_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>userid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>plaintext_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>email</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>birthdate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and initializes a new user account with validated and securely stored data. </p>
<p >This function performs the following:</p><ul>
<li>Validates all input parameters (user ID, password, email, and birthdate).</li>
<li>Enforces password security requirements.</li>
<li>Validates email and birthdate format.</li>
<li>Initializes Libsodium for cryptographic operations.</li>
<li>Allocates and populates a new <code><a class="el" href="structaccount__t.html">account_t</a></code> structure.</li>
<li>Hashes and converts plaintext_password to a hashed version using <code>crypto_pwhash_str()</code>.</li>
<li>Securely copies strings into fixed-size buffers with truncation protection.</li>
</ul>
<p >If any validation or operation fails, an error is logged and <code>NULL</code> is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">userid</td><td>A null-terminated string representing the user ID. </td></tr>
    <tr><td class="paramname">plaintext_password</td><td>A null-terminated string representing the user's password in plaintext. </td></tr>
    <tr><td class="paramname">email</td><td>A null-terminated string representing the user's email address. </td></tr>
    <tr><td class="paramname">birthdate</td><td>A null-terminated string in "YYYY-MM-DD" format representing the user's birthdate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>All input pointers must be non-NULL. </dd>
<dd>
<code>sodium_init()</code> must succeed before using Libsodium cryptographic functions. </dd>
<dd>
Constants <code>USER_ID_LENGTH</code>, <code>MAX_PW_LEN</code>, <code>EMAIL_LENGTH</code>, and <code>BIRTHDATE_LENGTH</code> must be properly defined.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>On success, a heap-allocated <code><a class="el" href="structaccount__t.html">account_t</a></code> structure is returned, containing securely copied and hashed data. On failure, appropriate error is logged and null is returned.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>'true' if pointer to a newly allocated and initialized <code><a class="el" href="structaccount__t.html">account_t</a></code> struct on success; 'false if <code>NULL</code> or any validation/operation fails. </dd></dl>

</div>
</div>
<a id="af686b29dd44e962dd68627d051e96a65" name="af686b29dd44e962dd68627d051e96a65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af686b29dd44e962dd68627d051e96a65">&#9670;&nbsp;</a></span>account_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void account_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Securely deallocates and wipes an <code><a class="el" href="structaccount__t.html">account_t</a></code> structure from memory. </p>
<p >This function performs the following:</p><ul>
<li>Log successful access to the structure.</li>
<li>Securely erase its contents using <code>sodium_memzero()</code>.</li>
<li>Free the allocated memory.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>Pointer to the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure to be securely freed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acc</code> must either be NULL or points to a valid <code><a class="el" href="structaccount__t.html">account_t</a></code> struct.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>If <code>acc</code> is non-NULL then its contents will be wiped securely and memory freed.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

</div>
</div>
<a id="af9c70fb0d71e6d3a8281fe6d456c0bf0" name="af9c70fb0d71e6d3a8281fe6d456c0bf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9c70fb0d71e6d3a8281fe6d456c0bf0">&#9670;&nbsp;</a></span>account_is_banned()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool account_is_banned </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether a user account is currently banned based on the unban timestamp. </p>
<p >This function determines if an account is banned by comparing the current time with the <code>unban_time</code> field in the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure:</p><ul>
<li>If <code>unban_time</code> is 0, the account is considered not banned.</li>
<li>If the current time is not retrievable, the function conservatively returns <code>true</code>.</li>
<li>Otherwise, the function returns <code>true</code> if the unban time is still in the future.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>Pointer to the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure to check.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acc</code> must not be NULL.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>Logs the result of the ban check and returns the appropriate boolean value.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the account is banned (i.e., <code>unban_time</code> is in the future), <code>false</code> if the account is NULL or the current time cannot be determined; </dd></dl>

</div>
</div>
<a id="a34a441e59238b76a8cd7f36c94a1ae1b" name="a34a441e59238b76a8cd7f36c94a1ae1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34a441e59238b76a8cd7f36c94a1ae1b">&#9670;&nbsp;</a></span>account_is_expired()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool account_is_expired </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines whether a user account has expired based on the expiration timestamp. </p>
<p >This function checks if the <code>expiration_time</code> field in the given <code><a class="el" href="structaccount__t.html">account_t</a></code> structure indicates that the account is no longer valid:</p><ul>
<li>If <code>expiration_time</code> is 0, the account is considered non-expiring and active.</li>
<li>If the current system time cannot be retrieved, the function conservatively returns <code>true</code>.</li>
<li>Otherwise, it returns <code>true</code> if the expiration time is earlier than the current time.</li>
</ul>
<p >Logging is performed to handle and report null account pointers and system time retrieval failures.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>Pointer to the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure to check for expiration.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acc</code> must not be NULL.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>Logs an error if the account pointer is NULL or if the current time cannot be retrieved.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the account is expired, if the account is NULL, or if the current time is unavailable; <code>false</code> otherwise. </dd></dl>

</div>
</div>
<a id="a0d1dafdb93c9614ad833f3f940263d28" name="a0d1dafdb93c9614ad833f3f940263d28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d1dafdb93c9614ad833f3f940263d28">&#9670;&nbsp;</a></span>account_print_summary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool account_print_summary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints a summary of the given account to the specified file descriptor. </p>
<p >This function formats key account information such as user ID, email, birthdate, login statistics, IP address, and last login time. It writes the summary to a file descriptor (e.g., a pipe or file) using <code>safe_fd_printf()</code>. If any write fails, the function returns <code>false</code> to indicate failure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acct</td><td>Pointer to the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure to summarize. </td></tr>
    <tr><td class="paramname">fd</td><td>A writable file descriptor where the summary should be printed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acct</code> must not be NULL. </dd>
<dd>
<code>fd</code> must be a valid writable file descriptor.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>If successful, writes the formatted summary to the output. Logs success or any failures.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the summary was printed successfully; <code>false</code> on any formatting or write error. </dd></dl>

</div>
</div>
<a id="aa08ce919568178b2a576aa6cf4c26930" name="aa08ce919568178b2a576aa6cf4c26930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa08ce919568178b2a576aa6cf4c26930">&#9670;&nbsp;</a></span>account_record_login_failure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void account_record_login_failure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Records a failed login attempt for the specified user account. </p>
<p >This function increments the <code>login_fail_count</code> field in the given <code><a class="el" href="structaccount__t.html">account_t</a></code> structure. It also logs the failed attempt, including the user ID and current failure count. If the failure count has reached <code>UINT_MAX</code>, no further increment is performed and a warning is logged instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>Pointer to the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure associated with the login attempt.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acc</code> must not be NULL.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>If <code>login_fail_count</code> is less than <code>UINT_MAX</code>, it is incremented by one. Log entry is created.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

</div>
</div>
<a id="a2c3dd2f57c748c5d4502017deedcd1db" name="a2c3dd2f57c748c5d4502017deedcd1db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c3dd2f57c748c5d4502017deedcd1db">&#9670;&nbsp;</a></span>account_record_login_success()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void account_record_login_success </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ip4_addr_t&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Records a successful login for a user account, updating metadata and logging the event. </p>
<p >This function updates the given <code><a class="el" href="structaccount__t.html">account_t</a></code> structure to reflect a successful login event by:</p><ul>
<li>Storing the current time in <code>last_login_time</code>.</li>
<li>Saving the provided IPv4 address to <code>last_ip</code>.</li>
<li>Resetting the <code>login_fail_count</code> to zero.</li>
</ul>
<p >It converts the IP address to a readable string using <code>inet_ntop()</code> and formats the timestamp using <code>format_time()</code>. If IP conversion fails, it falls back to the string <code>"unknown"</code> using <code>safe_str_copy()</code>. Errors and successes are logged to aid in debugging and auditing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>Pointer to the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure representing the authenticated user. </td></tr>
    <tr><td class="paramname">ip</td><td>The IPv4 address (<code>ip4_addr_t</code>) from which the login occurred.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acc</code> must not be NULL.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>The account's <code>last_login_time</code>, <code>last_ip</code>, and <code>login_fail_count</code> fields are updated. Log entries are provided to indicate the time and IP of the login event.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

</div>
</div>
<a id="a5da35963ec07426278f66f9d37db58cb" name="a5da35963ec07426278f66f9d37db58cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5da35963ec07426278f66f9d37db58cb">&#9670;&nbsp;</a></span>account_set_email()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void account_set_email </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>new_email</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide user function to updates the email field of an existing <code><a class="el" href="structaccount__t.html">account_t</a></code> structure. </p>
<p >This function performs the following:</p><ul>
<li>checks for null inputs</li>
<li>validates the format of the new email string using <code>check_email()</code>.</li>
<li>Once validated, securely copy it into acc-&gt;email to update new value.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>Pointer to the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure whose email should be updated. </td></tr>
    <tr><td class="paramname">new_email</td><td>A null-terminated string representing the new email address.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acc</code> and <code>new_email</code> must not be NULL. </dd>
<dd>
<code>new_email</code> must pass format validation via <code>check_email()</code>. </dd>
<dd>
<code>EMAIL_LENGTH</code> must be defined and consistent.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>If validation succeeds, <code>acc-&gt;email</code> is updated with the new value; otherwise, the original email remains unchanged.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

</div>
</div>
<a id="a10db748111392ca7df1d47f35a5e8b21" name="a10db748111392ca7df1d47f35a5e8b21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10db748111392ca7df1d47f35a5e8b21">&#9670;&nbsp;</a></span>account_set_expiration_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void account_set_expiration_time </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the expiration time for a user account based on a duration from the current time. </p>
<p >This function sets the <code>expiration_time</code> field in the given <code><a class="el" href="structaccount__t.html">account_t</a></code> structure:</p><ul>
<li>If <code>t == 0</code>, the account is set to never expire (<code>expiration_time</code> is set to 0).</li>
<li>If <code>t &gt; 0</code>, it adds the duration <code>t</code> (in seconds) to the current time and sets it as the expiration time.</li>
<li>If <code>t &gt; MAX_DURATION</code>, it is clamped to <code>MAX_DURATION</code> and a warning is logged.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>Pointer to the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure whose expiration time should be updated. </td></tr>
    <tr><td class="paramname">t</td><td>Duration in seconds from the current time after which the account should expire. Use 0 to disable expiration.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acc</code> must not be NULL. </dd>
<dd>
<code>MAX_DURATION</code> must be defined.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>If valid, updates <code>acc-&gt;expiration_time</code> based on the current time and duration. Otherwise, no change occurs.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

</div>
</div>
<a id="aada84f2a8333027836a619f14c554ba2" name="aada84f2a8333027836a619f14c554ba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aada84f2a8333027836a619f14c554ba2">&#9670;&nbsp;</a></span>account_set_unban_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void account_set_unban_time </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the unban time for a user account based on a duration from the current time. </p>
<p >This function updates the <code>unban_time</code> field in the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure as follows:</p><ul>
<li>If <code>t == 0</code>, the ban is cleared (<code>unban_time</code> is set to 0).</li>
<li>If <code>t &gt; 0</code>, it adds the duration <code>t</code> (in seconds) to the current system time.</li>
<li>If <code>t</code> exceeds <code>MAX_DURATION</code>, it is clamped to <code>MAX_DURATION</code> and a warning is logged.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>Pointer to the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure to update. </td></tr>
    <tr><td class="paramname">t</td><td>Duration in seconds to set as the remaining ban time. Use 0 to remove the ban.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acc</code> must not be NULL. </dd>
<dd>
<code>MAX_DURATION</code> must be defined.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>Updates <code>acc-&gt;unban_time</code> based on the specified duration and current time.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

</div>
</div>
<a id="aa4ca3ecc137d919f74b096b4c9c69e06" name="aa4ca3ecc137d919f74b096b4c9c69e06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4ca3ecc137d919f74b096b4c9c69e06">&#9670;&nbsp;</a></span>account_update_password()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool account_update_password </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>new_plaintext_password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the stored password hash in an <code><a class="el" href="structaccount__t.html">account_t</a></code> structure with a new plaintext password provided from user. </p>
<p >This function performs the following:</p><ul>
<li>Check new password meets defined security policies.</li>
<li>Locking memory using <code>sodium_mlock()</code> to protect the password buffer.</li>
<li>Copying the password into the secure buffer using <code>safe_str_copy()</code>.</li>
<li>Hashing the new plaintext password provided using <code>crypto_pwhash_str()</code>.</li>
<li>Clean and unlock memory to remove residual sensitive data.</li>
<li>Log all major events (failures/success) for auditing and debugging.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>Pointer to the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure whose password will be updated. </td></tr>
    <tr><td class="paramname">new_plaintext_password</td><td>Null-terminated string representing the new user-provided password.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acc</code> and <code>new_plaintext_password</code> must not be NULL. </dd>
<dd>
<code>sodium_init()</code> must succeed before any cryptographic operations. </dd>
<dd>
<code>new_plaintext_password</code> must pass internal validation via <code>validate_password()</code>.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>If successful, <code>acc-&gt;password_hash</code> is updated with the new securely hashed password. The password buffer is securely wiped and unlocked regardless of outcome.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the password was successfully updated and hashed; <code>false</code> if validation, memory protection, or hashing fails. </dd></dl>

</div>
</div>
<a id="a0051b990f5e6a9e4800ed05a7c72fb4d" name="a0051b990f5e6a9e4800ed05a7c72fb4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0051b990f5e6a9e4800ed05a7c72fb4d">&#9670;&nbsp;</a></span>account_validate_password()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool account_validate_password </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structaccount__t.html">account_t</a> *&#160;</td>
          <td class="paramname"><em>acc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>plaintext_password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validates a user's plaintext password against the stored password hash. </p>
<p >This function performs the following:</p><ul>
<li>Check that Libsodium library (if not already initialized).</li>
<li>Check provided plaintext password meets password policy in <code>validate_password()</code>.</li>
<li>Locks memory for the password buffer using <code>sodium_mlock()</code> to prevent it from being swapped.</li>
<li>Securely copies the password into the locked buffer.</li>
<li>Verifies the password against the stored hash in the <code><a class="el" href="structaccount__t.html">account_t</a></code> structure using libsodium's - <code>crypto_pwhash_str_verify()</code>.</li>
<li>Cleans and unlocks the memory after verification.</li>
<li>Log all major events (failures/success) for auditing and debugging.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>Pointer to a valid <code><a class="el" href="structaccount__t.html">account_t</a></code> structure containing the stored password hash. </td></tr>
    <tr><td class="paramname">plaintext_password</td><td>A null-terminated string representing the user-provided password to validate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>acc</code> and <code>plaintext_password</code> must not be NULL. </dd>
<dd>
<code>sodium_init()</code> must succeed prior to cryptographic operations. </dd>
<dd>
<code>plaintext_password</code> must pass internal policy checks via <code>validate_password()</code>.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>On success, securely unlocks and clears the password buffer and return <code>true</code>. On failure, record log error and reutrn <code>false</code>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the plaintext password matches the stored hash; otherwise, <code>false</code>. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
