\hypertarget{login_8h_source}{}\doxysection{login.\+h}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// DO NOT SUBMIT THIS FILE}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{// When submitting your project, this file will be overwritten}}
\DoxyCodeLine{4 \textcolor{comment}{// by the automated build and test system.}}
\DoxyCodeLine{5 \textcolor{comment}{//}}
\DoxyCodeLine{6 \textcolor{comment}{// DO NOT EDIT THIS FILE}}
\DoxyCodeLine{7 \textcolor{comment}{//}}
\DoxyCodeLine{8 \textcolor{comment}{// Since any changes you make will be lost when you submit your project.}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#ifndef LOGIN\_H}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#define LOGIN\_H}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}account.h"{}}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <stdint.h>}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <stdbool.h>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <time.h>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#define SESSION\_INVALID\_ACCOUNT\_ID (-\/1)}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{}
\DoxyCodeLine{23   \textcolor{keywordtype}{int} account\_id;         \textcolor{comment}{// ID of the authenticated account}}
\DoxyCodeLine{24   time\_t session\_start;   \textcolor{comment}{// login start time}}
\DoxyCodeLine{25   time\_t expiration\_time; \textcolor{comment}{// session expiry time}}
\DoxyCodeLine{26 \} \mbox{\hyperlink{structlogin__session__data__t}{login\_session\_data\_t}};}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{}
\DoxyCodeLine{29   LOGIN\_SUCCESS = 0,}
\DoxyCodeLine{30   LOGIN\_FAIL\_USER\_NOT\_FOUND,}
\DoxyCodeLine{31   LOGIN\_FAIL\_BAD\_PASSWORD,}
\DoxyCodeLine{32   LOGIN\_FAIL\_ACCOUNT\_EXPIRED,}
\DoxyCodeLine{33   LOGIN\_FAIL\_ACCOUNT\_BANNED,}
\DoxyCodeLine{34   LOGIN\_FAIL\_IP\_BANNED,}
\DoxyCodeLine{35   LOGIN\_FAIL\_INTERNAL\_ERROR}
\DoxyCodeLine{36 \} login\_result\_t;}
\DoxyCodeLine{37 }
\DoxyCodeLine{56 login\_result\_t \mbox{\hyperlink{login_8c_abf3b37509991b6601c578b8af8cbbacd}{handle\_login}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *userid, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *password,}
\DoxyCodeLine{57                             ip4\_addr\_t client\_ip, time\_t login\_time,}
\DoxyCodeLine{58                             \textcolor{keywordtype}{int} client\_output\_fd, \textcolor{keywordtype}{int} log\_fd,}
\DoxyCodeLine{59                             \mbox{\hyperlink{structlogin__session__data__t}{login\_session\_data\_t}} *session);}
\DoxyCodeLine{60 }
\DoxyCodeLine{61 }
\DoxyCodeLine{62 }
\DoxyCodeLine{63 }
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// LOGIN\_H}}

\end{DoxyCode}
